    <div>
      <h4><em><span id="track_info"></span></em></h4>

      <table class="table text-center">
        <tr>
          <td></td>
          <td>
            <a class="btn btn-inverse btn-default btn-lg player" id="volume_up">
              <span class="glyphicon glyphicon-volume-up" aria-hidden="true"></span>
            </a>
          </td>
          <td></td>
        </tr>

        <tr>
          <td>
            <a class="btn btn-lg btn-primary player" id="prev_track" role="button">
              <span class="glyphicon glyphicon-backward" aria-hidden="true"></span>
            </a>
          </td>
          <td>

            <a class="btn btn-lg btn-danger player" id="pause" role="button" style="display: none;">
              <span class="glyphicon glyphicon-pause" aria-hidden="true"></span>
            </a>

            <a class="btn btn-lg btn-danger player" id="play" role="button">
              <span class="glyphicon glyphicon-play" aria-hidden="true"></span>
            </a>

          </td>
          <td>
            <a class="btn btn-lg btn-primary player" id="next_track" role="button">
              <span class="glyphicon glyphicon-forward" aria-hidden="true"></span>
            </a>
          </td>
        </tr>

        <tr>
          <td></td>
          <td>
            <a class="btn btn-inverse btn-default btn-lg player" id="volume_down">
              <span class="glyphicon glyphicon-volume-down" aria-hidden="true"></span>
            </a>
          </td>
          <td></td>
        </tr>
      </table>

      <div class="progress">
        <div id="volume_value" class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
          Volume 100%
        </div>
      </div>
    </div>

<script>
  function go_90s(title) {
    return '<marquee scrollamount="10">' + title + '</marquee>';
  }

  function switch_to_play(playing) {
    if (playing) {
      $('#pause').show();
      $('#play').hide();
    } else {
      $('#pause').hide();
      $('#play').show();
    }
  }

  $(document).ready(function(){
    window.onload = function() {
      //create a new instance of shake.js.
      var myShakeEvent = new Shake({
        threshold: 15
      });
      // start listening to device motion
      myShakeEvent.start();
      // register a shake event
      window.addEventListener('shake', shakeEventDidOccur, false);
      //shake event callback
      function shakeEventDidOccur () {
        // when smartphone is shaking go to next track
        ws.send('next_track');
      }
    };

    // web socket stuff

    var ws = new WebSocket('ws://' + window.location.host + '/auth/<%= Base64.urlsafe_encode64(settings.session_secret) %>');
    ws.onopen  = function() { console.log('successfully connected to WebSocket server!'); };
    ws.onclose = function() { console.log('WebSocket server went down!'); location.reload(); };
    ws.onmessage = function(m) {
      console.log('data received: ' + m.data);

      if (m.data == 'pause') {
        switch_to_play(false);
      } else if (isFinite(String(m.data))) { // check if incoming data is a number
        $('#volume_value').attr('aria-valuenow', m.data);
        $('#volume_value').attr('style', 'width: ' + m.data + '%;');
        $('#volume_value').html('Volume ' + m.data + '%');
      } else {
        // incoming data is a string thus it is interpreted as track name
        $('#track_info').html(go_90s(m.data));
        switch_to_play(true);
      }
    }

    // button events

    $(".player").click(function(){
      // when clicked volume up button and volume is already to max then do not
      // send request to the server, same thing for volume down button

      if (!(this.id == 'volume_up' && $('#volume_value').text() == 'Volume 100%') &&
          !(this.id == 'volume_down' && $('#volume_value').text() == 'Volume 0%')) {
        ws.send(this.id);
      }
    });
  });
</script>
